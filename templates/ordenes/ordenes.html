{% extends 'public/base.html' %}
{% block title %}Órdenes de Trabajo{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h3 class="fw-bold">Órdenes de Trabajo</h3>
      <p class="text-muted mb-0">Seguimiento de órdenes activas, pendientes y finalizadas</p>
    </div>
    <a href="{% url 'nueva_orden' %}" class="btn btn-danger"><i class="bi bi-plus-circle me-2"></i>Nueva Orden</a>
  </div>
  <style>
    .estado{
      color: #ffffff;
      padding: 5px;
      border-radius: 5px;
      font-weight: bold;
    }
    .estado-pendiente {
      background-color: orange;
    }
    .estado-proceso { background-color: blue; }
    .estado-terminado { background-color: green; }
    .estado-cancelado { background-color: red; }
  </style>
  <div class="card shadow-sm border-0">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th><i class="bi bi-hash"></i> No. Orden</th>
              <th><i class="bi bi-person-fill"></i> Cliente</th>
              <th><i class="bi bi-car-front"></i> Vehículo</th>
              <th><i class="bi bi-calendar-event"></i> Entrega</th>
              <th><i class="bi bi-check2-circle"></i> Estado</th>
              <th><i class="bi bi-gear-fill"></i> Acciones</th>
            </tr>
          </thead>
           <tbody>
            {% for orden in ordenes %}
              <tr>
                <td>{{ orden.id_orden|stringformat:"05d" }}</td>
                <td>{{ orden.id_vehiculo.cliente }}</td>
                <td>{{ orden.id_vehiculo}}</td>
                <td>{{ orden.entrega_estimada}}</td>
                <td>
                  <span class="estado
                    {% if orden.estado == 'P' %}estado-pendiente
                    {% elif orden.estado == 'E' %}estado-proceso
                    {% elif orden.estado == 'T' %}estado-terminado
                    {% else %}estado-cancelado{% endif %}">
                  {{ orden.get_estado_display }}
                  </span>
                </td>
                <td>
                  <!-- Botom de Ver -->
                  <a href="{% url 'ver_orden' orden.id_orden %}" class="btn btn-sm btn-outline-success"><i class="bi bi-eye"></i></a>
                  <!-- Botom de Editar -->
                  <a href="" class="btn btn-sm btn-outline-primary"><i class="bi bi-pencil-square"></i></a>
                </td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="5" class="text-center">No hay ordenes registradas.</td>
              </tr>
            {% endfor %}
            </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
